import{i as y,l as v,A as _,_ as I,j as T,o as E,k as p,P as m,t as x,c as u,a as c,b as e,m as A,w as S,g as h,f as i,d as g,F as w,r as C,n as H,q as B,v as D,u as N,s as j,e as a,p as L,h as V}from"./index.1ee95800.js";class F{async getCommentsByEventId(s){const l=await y.get("api/events/"+s+"/comments");v.log("getting event comments",l.data),_.comments=l.data}async createComment(s){const l=await y.post("api/comments",s);v.log("creating comment",l.data),_.comments.push(l.data)}async deleteComment(s){const l=await y.delete("api/comments/"+s);v.log("deleting comments",l.data),_.comments=_.comments.filter(t=>t.id!=s)}}const f=new F;const O={setup(){const r=T({}),s=N();E(()=>{l(),k(),t()});async function l(){try{await p.getEventById(s.params.eventId)}catch(n){m.error(n.message),v.error(n)}}async function t(){try{await x.getTicketHolders(s.params.eventId)}catch(n){m.error(n.message),v.error(n)}}async function k(){try{await f.getCommentsByEventId(s.params.eventId)}catch(n){m.error(n.message),v.error(n)}}async function b(){try{r.value.eventId=s.params.eventId,await f.createComment(r.value),r.value={},m.toast("Comment was posted")}catch(n){m.error(n.message),v.error(n)}}return{editable:r,createComment:b,myAccount:u(()=>_.account),event:u(()=>_.activeEvent),comments:u(()=>_.comments),ticketHolders:u(()=>_.ticketHolders),isAttending:u(()=>_.ticketHolders.find(n=>n.accountId==_.account.id)),async cancelEvent(n){try{await m.confirm("cancel event?")&&await p.cancelEvent(n)}catch(o){m.error(o.message),v.log(o)}},async getTicket(){try{await x.getTicket({eventId:s.params.eventId})}catch(n){m.error(n.message)}},async deleteComment(n){try{await m.confirm("delete comment?")&&await f.deleteComment(n)}catch(o){m.error(o.message),v.log(o.message)}}}}},d=r=>(L("data-v-6f5ec1ec"),r=r(),V(),r),P={class:"container-fluid bg-dark"},M={key:0,class:"row"},R={class:"col-12 mt-3"},G={class:"d-flex justify-content-center"},U={key:0,class:"text-danger"},W=d(()=>e("h1",null,"Event has been canceled \u{1F62D}",-1)),q=[W],z={key:1,class:"text-success"},J=["src"],K={class:"row bg-info p-3 m-0"},Q={class:"col-12 mt-3"},X=d(()=>e("span",{class:"text-success"},"FUN",-1)),Y=d(()=>e("span",{class:"text-success"},"LOCATION",-1)),Z=d(()=>e("span",{class:"text-success"},"DATE",-1)),$=d(()=>e("span",{class:"text-success"},"EVENT CREATOR",-1)),ee=d(()=>e("span",{class:"text-success"},"INFO",-1)),te={key:0,class:"d-flex justify-content-end pb-3"},se={class:"p-2 text-danger"},ne=d(()=>e("button",{disabled:"",class:"btn btn-danger"},"Get Tickets!",-1)),oe={key:1,class:"d-flex justify-content-end pb-3"},ce={key:0},ae={class:"p-2 text-danger"},ie={key:1},de={class:"p-2 text-success"},re={key:2},le={key:0,class:"row card m-0 bg-warning"},me=d(()=>e("h2",null,"Look who's going!",-1)),_e={class:"col-12 d-flex m-2"},ve={class:"d-flex p-2"},he=["src","title"],ge={key:1,class:"row justify-content-center"},ue={class:"col-10 d-flex card"},ye={class:"text-dark"},fe=h("What people are saying about "),ke={class:"text-info border-bottom"},be={class:"form-group"},pe=d(()=>e("label",{for:"body"},"What do you think?",-1)),xe=d(()=>e("div",{class:"d-flex justify-content-end m-3"},[e("button",{class:"btn btn-success fw-bold"},"submit")],-1)),we={class:"text-dark d-flex p-3"},Ce={class:"d-flex"},Ie=["onClick"],Te={class:"align-items-center d-flex me-3"},Ee=["src"],Ae={key:0},Se=d(()=>e("span",{class:"text-success"},"Has Tickets",-1)),He=[Se],Be={class:"p-3 card elevation-5"};function De(r,s,l,t,k,b){const n=j("H1");return a(),c("div",P,[t.event?(a(),c("section",M,[e("div",R,[e("div",G,[t.event.isCanceled?(a(),c("div",U,q)):(a(),c("div",z,[A(n,null,{default:S(()=>[h(i(t.event.name),1)]),_:1})]))]),e("img",{src:t.event.coverImg,alt:"",class:"img-fluid poster-img rounded mb-3"},null,8,J)]),e("section",K,[e("div",Q,[e("h4",null,[X,h(" : "+i(t.event.type),1)]),e("h4",null,[Y,h(" : "+i(t.event.location),1)]),e("h4",null,[Z,h(" : "+i(new Date(t.event.startDate).toDateString()),1)]),e("h4",null,[$,h(" : "+i(t.event.creator.name),1)]),e("h4",null,[ee,h(": "+i(t.event.description),1)])]),t.event.isCanceled||t.event.capacity<=0||t.isAttending?(a(),c("div",te,[e("h4",se,"Tickets Left: "+i(t.event.capacity),1),ne])):(a(),c("div",oe,[t.event.capacity<=0||t.event.isCanceled?(a(),c("div",ce,[e("h4",ae,"Tickets Left: "+i(t.event.capacity),1)])):(a(),c("div",ie,[e("h4",de,"Tickets Left: "+i(t.event.capacity),1)])),e("button",{onClick:s[0]||(s[0]=o=>t.getTicket()),class:"btn btn-success fw-bold"},"Get Tickets!")])),t.event.isCanceled?g("",!0):(a(),c("div",re,[t.event.creatorId==t.myAccount.id?(a(),c("button",{key:0,onClick:s[1]||(s[1]=o=>t.cancelEvent(t.event.id)),class:"btn btn-danger fw-bold"},"Cancel Event")):g("",!0)]))]),t.event.isCanceled?g("",!0):(a(),c("section",le,[me,e("div",_e,[(a(!0),c(w,null,C(t.ticketHolders,o=>(a(),c("div",ve,[e("div",null,[e("img",{src:o.profile.picture,alt:"",class:"smaller-img rounded-circle",title:o.profile.name},null,8,he)])]))),256))])])),t.event.isCanceled?g("",!0):(a(),c("section",ge,[e("div",ue,[e("form",{onSubmit:s[3]||(s[3]=H(o=>t.createComment(),["prevent"]))},[e("h5",ye,[fe,e("span",ke,i(t.event.name),1)]),e("div",be,[pe,B(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.editable.body=o),placeholder:"Tell us what you think",class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[D,t.editable.body]])]),xe],32),(a(!0),c(w,null,C(t.comments,o=>(a(),c("div",we,[e("div",Ce,[t.myAccount.id==o.creatorId?(a(),c("button",{key:0,onClick:Ne=>t.deleteComment(o.id),class:"btn btn-danger mdi mdi-delete",title:"delete your comment"},null,8,Ie)):g("",!0),e("div",Te,[e("img",{src:o.creator.picture,alt:"",class:"rounded-circle comment-img"},null,8,Ee),o.isAttending?(a(),c("div",Ae,He)):g("",!0)]),e("div",Be,[e("h5",null,i(o.creator.name),1),h(" "+i(o.body),1)])])]))),256))])]))])):g("",!0)])}const Le=I(O,[["render",De],["__scopeId","data-v-6f5ec1ec"]]);export{Le as default};
